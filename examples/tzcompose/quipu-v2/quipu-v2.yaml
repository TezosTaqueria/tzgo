# core     KT1J8Hr3BP8bpbfmgGpRPoC9nAMSYtStZG43
# auction  KT1M8tp17Y2GWsYrZDBRXqdRNawgwyFDzmp4
# proxy    KT1LyF39wwaEWhwC8KyeC46SWtvmVi31iMd1
# registry KT1F8oyjko98F1L4323zbtBZiREZDcSQPJDi

version: alpha

# accounts:
#   name: dex-owner
#   id: 1


pipelines:

  quipu_baker_registry:
  - task: deploy
    alias: quipu_baker_registry
    script:
      code:
        file: baker_registry.json#michelson
      storage:
        args:
          "": {}

  quipu_dex_core:
  - task: deploy
    alias: quipu_dex_core
    script:
      code:
        file: dex_core.json#michelson
      storage:
        args:
          storage:
            token_metadata: {}
            ledger: {}
            accounts: {}
            tokens: {}
            token_to_id: {}
            pairs: {}
            permits: {}
            interface_fee: {}
            interface_tez_fee: {}
            auction_fee: {}
            auction_tez_fee: {}
            managers:
              - $base
            fees:
              interface_fee: 500000000000000
              swap_fee: 2250000000000000
              auction_fee: 750000000000000
              withdraw_fee_reward: 0
            admin: $base
            pending_admin: null
            baker_registry: $quipu_baker_registry
            flash_swaps_proxy: tz1Ke2h7sDdakHJQh8WX4Z372du1KChsksyU
            auction: tz1Ke2h7sDdakHJQh8WX4Z372du1KChsksyU
            permits_counter: 0
            default_expiry: 31564512
            entered: false
            tokens_count: 0
            collecting_period: 60480
            baker_rate_f: 500000000000000000
          dex_core_lambdas: {}
          metadata:
            "": 74657a6f732d73746f726167653a636f7265
            core: 7b226e616d65223a225175697075537761702045786368616e676520322e30222c2276657273696f6e223a2276312e302e30222c226465736372697074696f6e223a22446563656e7472616c697a65642065786368616e676520666f72207468652054657a6f732062617365642d617373657473206665617475726564207769746820666c617368206c6f616e7320616e64207072696365206f7261636c652e222c22617574686f7273223a5b224d6164666973682e536f6c7574696f6e73203c68747470733a2f2f7777772e6d6164666973682e736f6c7574696f6e733e225d2c22736f75726365223a7b22746f6f6c73223a5b224c69676f222c22466c657874657361225d7d2c22686f6d6570616765223a2268747470733a2f2f7175697075737761702e636f6d222c22696e7465726661636573223a5b22545a49502d303136225d2c226572726f7273223a5b7b226572726f72223a7b22737472696e67223a22343030227d2c22657870616e73696f6e223a7b22737472696e67223a2253656e646572206973206e6f742041646d696e2e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343031227d2c22657870616e73696f6e223a7b22737472696e67223a2253656e646572206973206e6f742050656e64696e672041646d696e2e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343032227d2c22657870616e73696f6e223a7b22737472696e67223a2253656e646572206973206e6f74204d616e616765722e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343033227d2c22657870616e73696f6e223a7b22737472696e67223a2253656e646572206973206e6f742044657820436f7265227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343034227d2c22657870616e73696f6e223a7b22737472696e67223a22464131323a205472616e7366657220656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343035227d2c22657870616e73696f6e223a7b22737472696e67223a224641323a205472616e7366657220656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343036227d2c22657870616e73696f6e223a7b22737472696e67223a2256616c756520697473206e6f74206e617420747970652e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343037227d2c22657870616e73696f6e223a7b22737472696e67223a2257726f6e6720746f6b656e2074797065227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343038227d2c22657870616e73696f6e223a7b22737472696e67223a224469766973696f6e206279207a65726f2e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343039227d2c22657870616e73696f6e223a7b22737472696e67223a22496d706c696374206163636f756e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343130227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65743a2046696c6c20656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343131227d2c22657870616e73696f6e223a7b22737472696e67223a2250656e64696e672061646d696e206973204e6f6e652e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343132227d2c22657870616e73696f6e223a7b22737472696e67223a224e6f6e2070617961626c6520656e747279706f696e742e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22343133227d2c22657870616e73696f6e223a7b22737472696e67223a225261746520746f6f20686967682e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313030227d2c22657870616e73696f6e223a7b22737472696e67223a224c616d6264612066756e6374696f6e207468617420747269656420746f2063616c6c20686173206e6f74206265656e20736574207965742e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313031227d2c22657870616e73696f6e223a7b22737472696e67223a224c616d6264612066756e6374696f6e207468617420747269656420746f207365742068617320616c7265616479206265656e207365742e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313032227d2c22657870616e73696f6e223a7b22737472696e67223a2254686520496e646578206f6620746865206c616d6264612066756e6374696f6e20796f7520747269656420746f207365742069732067726561746572207468616e206d6574686f6473206d617820696e646578227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313033227d2c22657870616e73696f6e223a7b22737472696e67223a22436f6e74726163742063616e277420756e7061636b206c616d6264612066756e6374696f6e20746f20636f72726573706f6e64696e672074797065202862726f6b656e206c616d626461206279746573292e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313034227d2c22657870616e73696f6e223a7b22737472696e67223a22496e636f7272656374206f72646572206f6620746f6b656e7320696e206120706169722e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313035227d2c22657870616e73696f6e223a7b22737472696e67223a225768656e206372656174696e672061206e657720706f6f6c2c2074686520696e697469616c20616d6f756e74206f6620746f6b656e204120697320302e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313036227d2c22657870616e73696f6e223a7b22737472696e67223a225768656e206372656174696e672061206e657720706f6f6c2c2074686520696e697469616c20616d6f756e74206f6620746f6b656e204220697320302e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313037227d2c22657870616e73696f6e223a7b22737472696e67223a22506f6f6c20616c7265616479206578697374732e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313038227d2c22657870616e73696f6e223a7b22737472696e67223a225061697220646f65736e277420657869737473227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313039227d2c22657870616e73696f6e223a7b22737472696e67223a224e6f206c697175696469747920696e2074686520706f6f6c227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313130227d2c22657870616e73696f6e223a7b22737472696e67223a2254686520616d6f756e74206f6620736861726573207472616e7366657272656420697320302e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313131227d2c22657870616e73696f6e223a7b22737472696e67223a22496e73756666696369656e7420616d6f756e74206f6620746f6b656e20412e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313132227d2c22657870616e73696f6e223a7b22737472696e67223a22496e73756666696369656e7420616d6f756e74206f6620746f6b656e20422e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313133227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65742061646472657373206973204e6f6e652e227d2c226c616e677561676573223a5b22656e225d7d2c6e756c6c2c7b226572726f72223a7b22737472696e67223a22313134227d2c22657870616e73696f6e223a7b22737472696e67223a22496e73756666696369656e74206c69717569646974792e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313135227d2c22657870616e73696f6e223a7b22737472696e67223a2254686520726571756573746564206d696e696d756d20616d6f756e74206f6620746f6b656e2041206f722042206166746572207468652064697665737420697320302e227d2c226c616e677561676573223a5b22656e225d7d2c6e756c6c2c7b226572726f72223a7b22737472696e67223a22313136227d2c22657870616e73696f6e223a7b22737472696e67223a2254686520726571756573746564206d696e696d756d20616d6f756e74206f6620746f6b656e2041206f72204220746f6f20686967682e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313137227d2c22657870616e73696f6e223a7b22737472696e67223a22456d70747920726f7574652e227d2c226c616e677561676573223a5b22656e225d7d2c6e756c6c2c7b226572726f72223a7b22737472696e67223a22313138227d2c22657870616e73696f6e223a7b22737472696e67223a225377617070656420616d6f756e7420697320302e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313139227d2c22657870616e73696f6e223a7b22737472696e67223a2257726f6e67207377617020726f7574652e227d2c226c616e677561676573223a5b22656e225d7d2c6e756c6c2c7b226572726f72223a7b22737472696e67223a22313230227d2c22657870616e73696f6e223a7b22737472696e67223a2254686520616d6f756e74206f662058545a207472616e7366657272656420696e2074686520706172616d6574657220616e642073656e7420746f2074686520636f6e747261637420617265206d69736d6174636865642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313231227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65743a20506f75725f6f757420656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c6e756c6c2c7b226572726f72223a7b22737472696e67223a22313232227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65743a20506f75725f6f76657220656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313233227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65743a2042616e5f62616b657220656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313234227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65743a20566f746520656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313235227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65743a2049735f62616e6e65645f62616b65722076696577206d6574686f64206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313236227d2c22657870616e73696f6e223a7b22737472696e67223a22466c6173685f73776170735f70726f78793a2044656675616c7420656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313237227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65743a204765745f74657a5f62616c616e63652076696577206d6574686f64206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313238227d2c22657870616e73696f6e223a7b22737472696e67223a224445583a20466c6173685f737761705f63616c6c6261636b20656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313239227d2c22657870616e73696f6e223a7b22737472696e67223a2257726f6e6720666c6173685f737761702072657475726e732e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313330227d2c22657870616e73696f6e223a7b22737472696e67223a22596f752063616e2774206c69737420796f757273656c6620617320612072656665727265722e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313331227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65743a2057697468647261775f7265776172647320656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313333227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65743a204765745f757365725f63616e6469646174652076696577206d6574686f64206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313334227d2c22657870616e73696f6e223a7b22737472696e67223a224445583a204c61756e63685f63616c6c6261636b20656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313335227d2c22657870616e73696f6e223a7b22737472696e67223a2241756374696f6e3a20526563656976655f66656520656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313336227d2c22657870616e73696f6e223a7b22737472696e67223a225265656e7472616e63792e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313337227d2c22657870616e73696f6e223a7b22737472696e67223a224445583a20436c6f736520656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313338227d2c22657870616e73696f6e223a7b22737472696e67223a224e6f7420656e74657265642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313430227d2c22657870616e73696f6e223a7b22737472696e67223a22566f7465722062616c616e636520697320302e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313431227d2c22657870616e73696f6e223a7b22737472696e67223a2257726f6e672072657365727665732073746174652e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313432227d2c22657870616e73696f6e223a7b22737472696e67223a2250616972204944206973204e6f6e652e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313433227d2c22657870616e73696f6e223a7b22737472696e67223a22416374696f6e206973206f757464617465642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313434227d2c22657870616e73696f6e223a7b22737472696e67223a224275636b65743a20436c61696d5f62616b65725f66756e6420656e747279706f696e74206e6f7420666f756e642e227d2c226c616e677561676573223a5b22656e225d7d2c7b226572726f72223a7b22737472696e67223a22313435227d2c22657870616e73696f6e223a7b22737472696e67223a2243616e277420636c61696d20696e7465726661636520666565206f6e2054657a2e227d2c226c616e677561676573223a5b22656e225d7d5d2c227669657773223a5b7b226e616d65223a22476574436f756e746572222c2270757265223a747275652c22696d706c656d656e746174696f6e73223a5b7b226d696368656c736f6e53746f7261676556696577223a7b2272657475726e54797065223a7b227072696d223a226e6174227d2c22636f6465223a5b7b227072696d223a22434152227d2c7b227072696d223a22474554222c2261726773223a5b7b22696e74223a223337227d5d7d5d7d7d5d7d2c7b226e616d65223a2247657444656661756c74457870697279222c2270757265223a747275652c22696d706c656d656e746174696f6e73223a5b7b226d696368656c736f6e53746f7261676556696577223a7b2272657475726e54797065223a7b227072696d223a226e6174227d2c22636f6465223a5b7b227072696d223a22434152227d2c7b227072696d223a22474554222c2261726773223a5b7b22696e74223a223339227d5d7d5d7d7d5d7d5d7d


  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 0
        func_bytes: "@dex_core_lambdas.json#0"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 1
        func_bytes: "@dex_core_lambdas.json#1"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 2
        func_bytes: "@dex_core_lambdas.json#2"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 3
        func_bytes: "@dex_core_lambdas.json#3"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 4
        func_bytes: "@dex_core_lambdas.json#4"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 5
        func_bytes: "@dex_core_lambdas.json#5"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 6
        func_bytes: "@dex_core_lambdas.json#6"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 7
        func_bytes: "@dex_core_lambdas.json#7"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 8
        func_bytes: "@dex_core_lambdas.json#8"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 9
        func_bytes: "@dex_core_lambdas.json#9"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 10
        func_bytes: "@dex_core_lambdas.json#10"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 11
        func_bytes: "@dex_core_lambdas.json#11"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 12
        func_bytes: "@dex_core_lambdas.json#12"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 13
        func_bytes: "@dex_core_lambdas.json#13"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 14
        func_bytes: "@dex_core_lambdas.json#14"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 15
        func_bytes: "@dex_core_lambdas.json#15"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 16
        func_bytes: "@dex_core_lambdas.json#16"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 17
        func_bytes: "@dex_core_lambdas.json#17"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 18
        func_bytes: "@dex_core_lambdas.json#18"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 19
        func_bytes: "@dex_core_lambdas.json#19"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 20
        func_bytes: "@dex_core_lambdas.json#20"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 21
        func_bytes: "@dex_core_lambdas.json#21"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 22
        func_bytes: "@dex_core_lambdas.json#22"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 23
        func_bytes: "@dex_core_lambdas.json#23"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 24
        func_bytes: "@dex_core_lambdas.json#24"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 25
        func_bytes: "@dex_core_lambdas.json#25"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 26
        func_bytes: "@dex_core_lambdas.json#26"

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: setup_func
      args:
        idx: 27
        func_bytes: "@dex_core_lambdas.json#27"


  quipu_flash_swaps_proxy:
  - task: deploy
    alias: quipu_flash_swaps_proxy
    script:
      code:
        file: flash_swaps_proxy.json#michelson
      storage:
        args:
          "": tz1Ke2h7sDdakHJQh8WX4Z372du1KChsksyU


  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: set_flash_swaps_proxy
      args:
        "": $quipu_flash_swaps_proxy


  quipu_auction:
  - task: deploy
    alias: quipu_auction
    script:
      code:
        file: auction_mock.json#michelson
      storage:
        args:
          owner: $base
          pending_owner: null
          dex: $quipu_dex_core
          fees: {}

  - task: call
    destination: $quipu_dex_core
    params:
      entrypoint: set_auction
      args:
        "": $quipu_auction


